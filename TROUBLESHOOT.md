#!/bin/bash

# ğŸ› Simple Deployment Troubleshooter

SERVER_IP="103.56.162.100"
SERVER_PORT="24700"

echo "ğŸ” TROUBLESHOOTING DEPLOYMENT"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "ğŸ“‹ Server: $SERVER_IP:$SERVER_PORT"
echo ""

echo "âš ï¸ Possible Issues & Solutions:"
echo ""

echo "âŒ Issue 1: Container didn't start"
echo " Solution: SSH to server and check"
echo " $ ssh -p 24700 root@103.56.162.100"
echo " $ docker ps -a"
echo " $ docker logs dictionary-mrvu-app"
echo ""

echo "âŒ Issue 2: Container crashed"
echo " Solution: Restart it"
echo " $ ssh -p 24700 root@103.56.162.100"
echo " $ docker restart dictionary-mrvu-app"
echo " $ docker logs dictionary-mrvu-app"
echo ""

echo "âŒ Issue 3: Port 3000 not accessible"
echo " Causes:"
echo " - Container not running"
echo " - Firewall blocking port"
echo " - App error on startup"
echo " "
echo " Solutions:"
echo " 1. Check if container is running"
echo " 2. Check logs: docker logs dictionary-mrvu-app"
echo " 3. Check firewall: sudo iptables -L -n"
echo ""

echo "âŒ Issue 4: Deployment script failed"
echo " Solution: Manual deployment"
echo " $ ssh -p 24700 root@103.56.162.100"
echo " $ cd /root/dictionary-mrvu"
echo " $ docker build -t dictionary-mrvu:latest ."
echo " $ docker stop dictionary-mrvu-app || true"
echo " $ docker rm dictionary-mrvu-app || true"
echo " $ docker run -d --name dictionary-mrvu-app -p 3000:3000 dictionary-mrvu:latest"
echo ""

echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "ğŸš€ QUICK FIX - Manual SSH & Check:"
echo ""
echo "Step 1: Connect to server"
echo " ssh -p 24700 root@103.56.162.100"
echo " Password: \_GHKpxi#Gmp4E8elT34o"
echo ""
echo "Step 2: Check Docker"
echo " docker ps -a"
echo ""
echo "Step 3: Check logs if not running"
echo " docker logs dictionary-mrvu-app"
echo ""
echo "Step 4: Restart if needed"
echo " docker restart dictionary-mrvu-app"
echo ""
echo "Step 5: Test locally"
echo " curl http://localhost:3000"
echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "ğŸ“ Debug Info Needed:"
echo ""
echo "When reporting issue, provide:"
echo "1. Output of: docker ps -a"
echo "2. Output of: docker logs dictionary-mrvu-app"
echo "3. Output of: netstat -tlnp | grep 3000"
echo "4. Try curl: curl http://localhost:3000"
echo ""
